# ============= VPS MQTT BROKER ACL =============

# API Server Access (username authentication)
user gateway
topic read iot/+/telemetry
topic read iot/+/status
topic read iot/+/access
topic read iot/+/alert
topic read gateway/status/+
topic write gateway/command/#

# Gateway Access (mTLS - CN from certificate)
user CN=gateway.local
topic write iot/Gateway1/telemetry
topic write iot/Gateway1/status
topic write iot/Gateway1/access
topic write iot/Gateway1/alert
topic write gateway/status/Gateway1
topic read gateway/command/#

# Gateway Access (password fallback if mTLS fails)
user Gateway1
topic write iot/Gateway1/telemetry
topic write iot/Gateway1/status
topic write iot/Gateway1/access
topic write iot/Gateway1/alert
topic write gateway/status/Gateway1
topic read gateway/command/#

# Admin user (for testing and management)
user admin
topic readwrite #

# Deny all by default
pattern read $SYS/#